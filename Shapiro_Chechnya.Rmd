---
title: "Replication of Lazarev (2019)"
author: "Daniel Shapiro"
date: "4/11/2020"
output: pdf_document
bibliography: bib.bib
link_citations: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(stargazer)
library(rstanarm)
library(bookdown)
library(foreign)
library(plyr)
library(dplyr)
library(Hmisc)
library(arm)
library(stargazer)
library(ggthemes)
require(ggplot2)
require(reshape2)
require(devtools)
require(scales)
library(lme4)
library(magrittr)
library(ggthemes)
library(RColorBrewer)
library(multiwayvcov)
library(sandwich)
library(lmtest)
library(ggplot2)
library(interactions)
library(tidybayes)
library(gt)
library(ggpubr)
```

# Abstract

Lazarev (2019) uses data describing individuals' choice between Russian state law, sharia law and customary law (adat) in Chechnya to show that gender can play a large role in societal splits in post-conflict societies. I was able to replicate all of the author's results. In my extension to Lazarev's paper, used the rstanarm package in R to check Lazarev's analysis with Bayesian regression, and the results confirmed the author's findings. I also pointed out certain areas where I disagreed somewhat with Lazarev's analysis and where I felt that the paper could improve. This paper's successful replication of Lazarev's findings helps strengthen Lazarev's argument about the role of gender in choice of legal organ, and my additional comments on Lazarev's anaylsis help to further discussion about postwar Chechnya and post-conflict society as a whole.

# Paper Overview and Introduction

This paper [@paper] by Egor Lazarev entitled "Laws In Conflict: Legacies of War, Gender, and Legal Pluralism in Chechnya" examines post-war Chechnya and how legacies of war affect people's choice between various legal processes. In modern-day Chechnya, there are three competing legal bodies: official Russian law, sharia courts [@sharia], and customary law (adat) [@adat]. The author argues that sharia and adat courts are traditionally more discriminatory towards women, and that women are more likely than men to turn to state courts rather than sharia courts or adat. The pattern of women choosing to turn to state courts for legal disputes rather than sharia or customary courts is exacerbated, as the author works to show through data, by the level to which a region was affected by violence during the Chechen wars [@wars]. In other words, conflict provided women with more opportunity to pursue their interests through official law. The author backs up his claim through data and through a comparison with neighboring Ingushetia, which has many similarities but has not gone through conflict. The enhanced opportunities for women in the legal process has been counterbalanced by an effort by the Ramzan Kadyrov government in Chechnya to retraditionalize the republic [@retraditionalize], and while women continue to look to state courts for assistance, Kadyrov works toward supporting more traditional forms of conflict resolution that favor men and Chechnya's traditionally patriarchal society. The author concludes that gender can play a large role in forming splits in post-conflict societies. Lazarev uses data throughout his paper to support his claims. The primary method he uses is ordinary least squares regression, in which Lazarev tests a number of different independent variables, including gender, exposure to conflict, distance from Chechnya’s capital (Groznyy), altitude (given cultural differences between upland and lowland Chechens [@mountain]) and various other variables on three indexes, which he labels indexRL, indexS and indexA. IndexRL, created by Lazarev early in the paper based on interview data, measures a given person’s likelihood to opt for Russian law, which indexS and indexA measure likelihood of sharia and adat, respectively. The author includes a number of graphics as well, including several ggplots, regression tables (created through stargazer) and others. Lazarev uses all of these methods to elucidate patterns in the data and arrive at his previously-described conclusions.

For my replications, I used R. The author's original code was in R as well, and had been posted on Harvard University's Dataverse.^[Data for this paper can be found at: https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/KOVT5Y] As I show in my Tables and Figures section, I was able to replicate all of the main tables and graphics that Lazarev provides in his paper. The author's code was well-formatted, and all of the necessary data was included. I have included Lazarev's original data with my comments in my Github repository.^[All analysis for this paper is available under Milestone-3.Rmd in my github repo: https://github.com/dfshapir/Replication] 

To replicate Lazarev's findings, I had to make very few changes to Lazarev's code. The only aspects of Lazarev's code that did not work were a couple of formatting commands that were not compatible with my computer. However, they did not impact the resulting figures and graphics. Thus, in my extension to Lazarev's paper, instead of showing new results based on my replication, I decided to expand on Lazarev's work, using Bayes and the rstanarm package in R to supplement Lazarev's ordinary least squares linear regressions. Using Bayes, I re-evaluated several of Lazarev's most important figures in his paper and show my results in the "Extension" section. Overall, this analysis proves that Lazarev's results hold well, further confirming that his findings are important and hold weight. 

This paper also discusses themes that Lazarev brought up in his work and questions certain arguments that the author makes. This paper looks into Lazarev's usage of Ingushetia as a quasi-"control" with which to compare Chechnya and looks deeper into the nature of Chechen sharia law. Finally, the paper also discusses some questions regarding Lazarev's data usage, including some of his choices of variables and his selection of which specific court cases to analyze, and provides some potential areas for future expansion.

# Literature Review

There exists a fairly significant literature on Chechnya, both in the West and in Russia. Some have written historical or ethnographic works on Chechnya and its inhabitants; good examples of this include Amjad Jaimoukha’s work *The Chechens* and Sebastian Smith’s *Allah’s Mountains*. Various aspects of history and ethnography have been captured in a novelistic style as well; Tolstoy’s *Hadji Murat* (published posthumously) describes 19th-century relations between Russians and North Caucasians, while Anthony Marra’s *A Constellation of Vital Phenomena* paints a picture of more modern-day life in Chechnya through a novelistic lens as well. The largest segment of the canon, however, is devoted to descriptions of Chechnya’s most recent two wars.

In English-language literature, much of this segment is devoted to the military side of the war. Robert Schaefer’s *The Insurgency in Chechnya and the North Caucasus: from Gazavat to Jihad* discusses Chechen history and many details of Chechnya’s recent wars; Brian Glyn Williams published a book on Chechnya in 2015 entitled *Inferno in Chechnya: the Russian-Chechen Wars, the Al Qaeda Myth, and the Boston Marathon Bombings*. Additionally, Julie Wilhelmsen published an analysis of the interwar period (the late 1990s), entitled *Russia’s Securitization of Chechnya: How war became acceptable*. Other works have been published on this subject as well, including Thomas de Waal’s *A Small Victorious War*, Anatol Lieven’s *Chechnya: Tombstone of Russian Power* and Emma Gilligan’s *Terror in Chechnya*. Le Heurou, Merlin, Regamey and Sieca-Kozlowski’s compilation of various works entitled *Chechnya at War and Beyond* is another good resource for general wartime information.

The Russian-language literature is somewhat more diverse. The military analyses of the conflict are much more focused on first-person accounts, including works such as *Bitva za Chechnyu* by Chechens D. B. Abdurakhmanov and Ya. Z. Akhmadov and narrative compilations such as Boltunov, Kobyletskiy, Skira and Chachukh’s *Zhestokie uroki chechnskoy voyny* and Efimov, Mikhaylov, Zinov’ev and Kolomiets’s *Chechenskaya voyna: rabota nad oshibkami*, published by the same organization. Other public figures involved in the war wrote personal memoirs about the conflict as well, including Vladimir Zorin’s *Kremnistyy put’ k miru* and Ruslan Khasbulatov’s *Vzorvannaya zhizn’*. Olga Allenova describes women’s personal experiences in her work *Chechnya ryadom: voyna glazami zhenshchiny*, while Tanya Lokshina compiled a set of personal narratives entitled *Chechnya: zhizn’ na voyne*. Historical accounts exist in Russian as well. 

The most significant factor that Russian-language writers have brought to the literature, however, is journalism. Two journalists stand out in their coverage of Chechnya over the years: Anna Politkovskaya and Elena Milashina. Politkovskaya was known for her in-depth, on-the-ground analyses of the situation in Chechnya, most specifically focusing on the Second Chechen War and its immediate aftermath. She wrote countless articles for the newspaper Novaya Gazeta, and published several books as well, including *A Dirty War*, published in 1999 first in Russian and translated to English, *Vtoraya Chechenskaya* (English variation: A Small Corner of Hell), and other books on Chechnya and the Putin regime. The second author, Milashina, also writes for Novaya Gazeta and has diligently covered Chechnya since Politkovskaya’s murder. While less internationally-renowned than Politkovskaya, Milashina is an outstanding Russian-language source (for accurate information on everything about Chechnya. 

Aside from Allenova's and Lokshina's contributions, however, very little scholarly attention has been paid directly to the issue of legal pluralism in present-day Chechnya or gender issues. Cremer (2012) wrote on the role of customary law (adat) in Chechnya, and Gammer (2005) described the role of sharia in Chechnya and Dagestan. But both of these papers focused on singular types of law, not law in a comparative perspective, nor how gender issues play into legal choice. Thus, Lazarev's paper, at the time it was written, fit into an important hole in the literature.

However, one contemporary paper that describes gender and legal pluralism in the region was written after Lazarev's paper (in October 2019) and while it was about Ingushetia, not Chechnya, it adds important perspectives. Izabella Yevloeva's *Yabloko razvoda: kak ingushskie zhenschiny boryutsya za vozvraschenie svoikh detey* describes how divorced women in Ingushetia are forced to come to terms with the fact that their children continue living with their ex-husbands, even despite the state courts ruling in their favor. She notes that in the fight for guardianship, adat, sharia and Russian state law all play important roles, and that while many women have been pleading their cases in Ingush state courts recently, sharia courts actually often tend to favor women in family matters. While the paper is somewhat different in its focus, it conflicts somewhat with Lazarev's conclusions by pointing out how women have lately become much more active in state courts in Ingushetia as well. In general, Lazarev's paper remains unique. Below, I quickly state my position on the replicability of Lazarev's paper, and then present my own extensions of Lazarev's work.

# Replication

As stated previously, I was able to replicate every aspect of Lazarev's paper. The only aspect of Lazarev's paper that was not perfectly replicable was the graphic that he labeled as Table 2 (in this paper labeled as Table 1). In this regression table, a few coefficients were around .001 off from Lazarev's original numbers. However, none of these slight discrepancies in any way change Lazarev's main conclusions. Overall, my replication was a success, and Lazarev's data-based conclusions hold steady with outside evaluation. As such, in my extension, I focus on ensuring that the results of Lazarev's regressions hold up under Bayesian analysis and critique Lazarev's analysis and data choices.

# Extension

My extension is split up into three sections. The first is devoted to Bayesian analysis, in which I run stan_glm() on all of Lazarev's OLS regressions to check if Lazarev's conclusions hold up. Next, I address some potential issues with Lazarev's analysis, dividing my evaluation into two separate critiques: analysis critiques and data critiques. These two categories overlap significantly, but I believe that splitting them up in such a way provides structure to the paper. In general, I believe that Lazarev comes to many convincing conclusions and uses data well to support his findings. Nonetheless, there are a few areas in which I believe that Lazarev could have been more thorough and/or where I believe that literature does not support Lazarev’s findings.

### Bayesian Regression

Lazarev has three sections in his code where he utilizes OLS regressions, labeled as Table 2, Table 3 and Table 4 in the data. I ran Bayesian analysis on these three Tables. First, I show the Bayesian regression equivalent for the figure that Lazarev labels as Table 2 in his data. This table measures how various variables are likely to effect a person's likelihood of choosing Russian Law, Sharia, or Adat. In his paper, Lazarev argues that women are much more likely to choose Russian law organs than men. Lazarev also includes various other independent variables, in addition to "female" in his regression, which I have included in the Bayesian regression as  well. The dependent variables are Lazarev's respective "indexes." I ran stan_glm() on Lazarev's variables, and put the resulting coefficients and error into a gt table for easy readibility.  

```{r include = FALSE, cache = TRUE}
set.seed(9)
upd_data <- read.csv2("raw-data/upd_wp_data_survey.csv")

stanl1 <- stan_glm(indexRL ~ killed + wounded + damaged + displaced + female + 
           as.factor(age_cohorts) + incomefull + edufull + unemployed + urban_com, data=upd_data, refresh = 0) 

tidystanl1 <- tidy(stanl1)

stanl2 <- stan_glm(indexS ~ killed + wounded + damaged + displaced + female + 
           as.factor(age_cohorts) + incomefull + edufull + unemployed + urban_com, data=upd_data, refresh = 0) 

tidystanl2 <- tidy(stanl2)

stanl3 <- stan_glm(indexA ~ killed + wounded + damaged + displaced + female + 
           as.factor(age_cohorts) + incomefull + edufull + unemployed + urban_com, data=upd_data, refresh = 0) 

tidystanl3 <- tidy(stanl3)
```

```{r graphics2}
tidytab2 <- cbind(tidystanl1, tidystanl2, tidystanl3)

tidytab2 <- tidytab2[,-c(4, 7)]

tidytab2 <- tidytab2 %>%
  mutate(Variable = term) %>%
  mutate(`Index Russian Law` = estimate) %>%
  mutate(`Error Russian Law` = std.error) %>%
  mutate(`Index Sharia` = estimate.1) %>%
  mutate(`Error Sharia` = std.error.1) %>%
  mutate(`Index Adat` = estimate.2) %>%
  mutate(`Error Adat` = std.error.2) %>%
  dplyr::select(Variable, `Index Russian Law`, `Error Russian Law`, `Index Sharia`, `Error Sharia`, `Index Adat`, `Error Adat`) %>%
  mutate(`Index Russian Law` = round(`Index Russian Law`, digits = 3)) %>%
  mutate(`Error Russian Law` = round(`Error Russian Law`, digits = 3)) %>%
  mutate(`Index Sharia` = round(`Index Sharia`, digits = 3)) %>%
  mutate(`Error Sharia` = round(`Error Sharia`, digits = 3)) %>%
  mutate(`Index Adat` = round(`Index Adat`, digits = 3)) %>%
  mutate(`Error Adat` = round(`Error Adat`, digits = 3))

tidytab2$Variable <- recode(tidytab2$Variable, `(Intercept)` = "Intercept",
                            `as.factor(age_cohorts)older` = "ageOlder",
                            `as.factor(age_cohorts)youth` = "ageYouth")
  
gttable2 <- tidytab2 %>% 
  gt() %>%
  tab_header(title = "Bayesian Regression of Lazarev Table 2",
             subtitle = "Data from Egor Lazarev") %>%
  as_latex()

gttable2
```

This table's results do not match Lazarev's results exactly. However, I believe that this is simply because they are different regressions, and because stan_glm() uses sampling, the chances of the stan_glm() coefficients matching the lm() coefficients exactly are very small. All coefficients here fall within the standard error of Lazarev's initial OLS regressions, and no patterns change. As such, I consider these results satisfactory.To further show how the coefficients match, I show here the spread of the coefficients for the relationship of the "female" variable and "indexRL"generated by my Bayesian regression.

```{r grph,fig.height=4, fig.width=5, fig.align='center'}
model_intercept <- tidystanl1$estimate[1]
model_slope <- tidystanl1$estimate[6]

draws <- spread_draws(stanl1, `(Intercept)`, `female`)

ggplot(upd_data, aes(x = female, y = indexRL)) +
  geom_jitter(width = 0.2) + 
  geom_abline(data = draws, aes(intercept = `(Intercept)`, slope = female), size = 0.1, alpha = 0.08, color = "skyblue") +
  geom_abline(intercept = model_intercept, slope = model_slope) +
  labs(title = "Relationship of Gender and Likelihood of Choosing \nRussian Law",
       subtitle = "Data from Egor Lazarev",
       x = "Gender (1 = Female, 0 = Male)",
       y = "Russian Law Choice Index")
```

As per a 2000 paper by King et al., this graphic focuses on a main point of Lazarev's piece (the relationship between gender and choice of legal system), shows uncertainty and presents results in a user-friendly manner [@manner]. The slope of this graph is about 0.09, meaning that women are estimated to be about 9 percent more likely to choose Russian law than men by my model. I include the distribution of slopes generated by my stan_glm() call, as represented by the blue lines surrounding the main slope.

Next, I show the Bayesian regression equivalent for the figure that Lazarev labels as Table 3 in his paper. Table 3 measures the effect of community victimization by violence in the war and gender on legal preference. Lazarev shows in his paper that not only are women more likely to choose Russian law organs, but the trend becomes even more apparent for women in communities victimized by violence. As such, he includes the "female" variable (for gender), the "com_exposure" variable (for a community's exposure to violence during the Chechen Wars) and the interaction between the two variables. My Bayesian table shows the same variables.

```{r tab3stan, cache = TRUE}
set.seed(9)
stank1 <- stan_glm(indexRL ~ com_exposure*female + 
           as.factor(age_cohorts) + incomefull + edufull + unemployed + urban_com + 
           russ_pop + lmaltitude + ldistance_Grozny + lcom_size + as.factor(rayon), data = upd_data, refresh = 0)
tidystank1 <- tidy(stank1)

stank2 <- stan_glm(indexS ~ com_exposure*female + 
           as.factor(age_cohorts) + incomefull + edufull + unemployed + urban_com + 
           russ_pop + lmaltitude + ldistance_Grozny + lcom_size + as.factor(rayon), data = upd_data, refresh = 0)
tidystank2 <- tidy(stank2)

stank3 <- stan_glm(indexA ~ com_exposure*female + 
           as.factor(age_cohorts) + incomefull + edufull + unemployed + urban_com + 
           russ_pop + lmaltitude + ldistance_Grozny + lcom_size + as.factor(rayon), data = upd_data, refresh = 0)
tidystank3 <- tidy(stank3)
```

```{r}
tidytab3 <- cbind(tidystank1, tidystank2, tidystank3)

tidytab3 <- tidytab3[c(1:3, 27),-c(4, 7)]

tidytab3 <- tidytab3 %>%
  mutate(Variable = term) %>%
  mutate(`Index Russian Law` = estimate) %>%
  mutate(`Error Russian Law` = std.error) %>%
  mutate(`Index Sharia` = estimate.1) %>%
  mutate(`Error Sharia` = std.error.1) %>%
  mutate(`Index Adat` = estimate.2) %>%
  mutate(`Error Adat` = std.error.2) %>%
  dplyr::select(Variable, `Index Russian Law`, `Error Russian Law`, `Index Sharia`, `Error Sharia`, `Index Adat`, `Error Adat`) %>%
  mutate(`Index Russian Law` = round(`Index Russian Law`, digits = 3)) %>%
  mutate(`Error Russian Law` = round(`Error Russian Law`, digits = 3)) %>%
  mutate(`Index Sharia` = round(`Index Sharia`, digits = 3)) %>%
  mutate(`Error Sharia` = round(`Error Sharia`, digits = 3)) %>%
  mutate(`Index Adat` = round(`Index Adat`, digits = 3)) %>%
  mutate(`Error Adat` = round(`Error Adat`, digits = 3))

tidytab3$Variable <- recode(tidytab3$Variable, `(Intercept)` = "Intercept",
                            `com_exposure` = "exposure",
                            `com_exposure:female` = "exp:female")

gttable3 <- tidytab3 %>% 
  gt() %>%
  tab_header(title = "Bayesian Regression of Lazarev Table 3",
             subtitle = "Data from Egor Lazarev") %>%
  as_latex()

gttable3
```

As with the previous table, stan_glm() outputs very similar coefficients to a regular OLS regression, strengthening Lazarev's conclusions.

Finally, I run Bayesian regressions for the variables described in Table 4. Table 4 in Lazarev's paper is constructed a bit differently than the other two tables, as Lazarev uses the istez_females variables as his dependent variable, which is binary ("itsets" meaning "plaintiff" in Russian). As such, Lazarev constructs three logistic regressions, measuring how likely it is that the plaintiff is female in a) all court cases in Chechnya over a given time period with individual plaintiffs, b) all of these cases that deal with family-related matters, and c) all of these cases that do not deal with family-related matters. In the article, we see that women are much more likely to be the plaintiff in family-related cases that in non-family-related cases, and that factors such as community vicitimization enhance this effect. I ran Bayesian regressions on Lazarev's data for these factors, and got similar results, showing again the strength of Lazarev's results.

```{r tab4stan, cache = TRUE}
set.seed(9)
reg_data <- read.csv2("raw-data/wp_data_courts.csv")

famdata <- reg_data[which(reg_data$family==1),]
nonfamdata <- reg_data[which(reg_data$family==0),]

stanm1 <- stan_glm(istez_females ~ com_exposure + urban +
            mountainous + russ_pop + pop_fem_share + 
            as.factor(year),family=binomial(link='logit'),data = reg_data, refresh = 0)
tidystanm1 <- tidy(stanm1)

stanm2 <- stan_glm(istez_females ~ com_exposure + urban +
            mountainous + russ_pop + pop_fem_share + 
            as.factor(year),family=binomial(link='logit'),data=famdata, refresh = 0)
tidystanm2 <- tidy(stanm2)

stanm3 <- stan_glm(istez_females ~ com_exposure + urban +
            mountainous + russ_pop + pop_fem_share + 
            as.factor(year),family=binomial(link='logit'),data=nonfamdata, refresh = 0)
tidystanm3 <- tidy(stanm3)
```

```{r tidytab4}
tidytab4 <- cbind(tidystanm1, tidystanm2, tidystanm3)

tidytab4 <- tidytab4[1:6,-c(4, 7)]

tidytab4 <- tidytab4 %>%
  mutate(Variable = term) %>%
  mutate(`All Cases` = estimate) %>%
  mutate(`Error All Cases` = std.error) %>%
  mutate(`Family Cases` = estimate.1) %>%
  mutate(`Error Family Cases` = std.error.1) %>%
  mutate(`Other Cases` = estimate.2) %>%
  mutate(`Error Other Cases` = std.error.2) %>%
  dplyr::select(Variable, `All Cases`, `Error All Cases`, `Family Cases`, `Error Family Cases`, `Other Cases`, `Error Other Cases`) %>%
  mutate(`All Cases` = round(`All Cases`, digits = 3)) %>%
  mutate(`Error All Cases` = round(`Error All Cases`, digits = 3)) %>%
  mutate(`Family Cases` = round(`Family Cases`, digits = 3)) %>%
  mutate(`Error Family Cases` = round(`Error Family Cases`, digits = 3)) %>%
  mutate(`Other Cases` = round(`Other Cases`, digits = 3)) %>%
  mutate(`Error Other Cases` = round(`Error Other Cases`, digits = 3))

tidytab4$Variable <- recode(tidytab4$Variable, `(Intercept)` = "Intercept",
                            `com_exposure` = "exposure",
                            `pop_fem_share` = "fem_share")

gttable4 <- tidytab4 %>% 
  gt() %>%
  tab_header(title = "Bayesian Regression of Lazarev Table 4",
             subtitle = "Data from Egor Lazarev") %>%
  as_latex()

gttable4
```

In total, Bayesian analysis of Lazarev's results confirmed and strengthened the author's findings. Regarding reproducibility and accuracy of reporting results, Lazarev does an excellent job. As such, I have devoted the next sections to discussions not of Lazarev's code or his results, but of his analysis and data. 

#### Analysis critiques

First of all, I believe that Lazarev oversimplifies sharia’s resurgence and role in Chechnya. He largely seems to place the promotion of sharia in modern-day Chechnya as a patriarchal response to increased women’s empowerment in Chechnya following the wars. While I understand the author's point, I believe that glosses over some other main reasons behind why Kadyrov started to re-emphasize sharia in the first place, thereby relying on gender as a driver a bit more heavily than necessary. After the Second Chechen War and the re-integration of Chechnya, Kadyrov was tasked with putting Chechnya back together. In this process, he had to negotiate with rebel Islamists and cajole them into rejoining society. Lazarev paints Chechnya’s re-Islamicization as a patriarchal reaction to a system in which women had more power in society. While this certainly may have been part of it, I believe that the political gymnastics necessary to persuade this radicalized portion of Chechnya to return to society was an equally (if not more) important driver. Ramzan’s retraditionalization of societal norms was a key factor in weakening the pull of the radical insurgency: Even if some rebel fighters believed that an independent Chechnya was doomed to fail, they would still support the insurgency because they believed that conservative Islam was right for Chechnya, especially in the face of “godless” Russia, and that a Chechnya within Russia would be forced to submit to Russian authority and potentially even give up its religion, as was the case in the Soviet Union. But by establishing Chechnya as a more conservative Islamic republic and tightening Chechnya’s societal laws, Kadyrov showed radicalized Chechens that it is indeed possible to exist inside Russia and still observe traditional, conservative Islam. For insurgency leaders, this posed a huge problem: how can one propagate an anti-Russia, anti-Kadyrov message when the Kadyrov regime has in fact implemented many of the ideologies that the insurgency wanted? I therefore believe that the switch to promoting a “macho” form of sharia was a strategic decision based not so much on stemming the rise of women into important positions in Chechnya, but on convincing radicalized and overwhelmingly male ex-fighters that insurgency was *not necessary*, because the new Chechnya would be based on a similar moral framework to the one that existed in the insurgency—simply inside Russia instead of outside it. While the data that Lazarev provides definitely supports his argument about the split in gender, I am somewhat worried that the author leans too heavily at times on gender as a driver of policy, especially regarding the re-establishment of sharia.

Secondly, Lazarev writes that “at the macro level, the gender gap in legal preferences is largely driven by men.” A number of questions spring from this statement: Does this claim undercut the whole argument of women’s empowerment? Is it really women who are making the decisions or men? Here, I think it’s important to return to Lazarev’s admittance in a small footnote that he “understand[s] women’s empowerment in a rather thin way—as an outcome of the process of transformation of gender roles characterized by an increase in women’s sense of agency, social status, material resources, and access to political and legal institutions.” It seems that this statement fits Lazarev’s definition; if women simply *sense* that they have more agency, then the results fit. Furthermore, at the macro level in Chechnya, essentially everything is largely driven by men as it is, so this statement should not come as a surprise. This aspect of Lazarev’s argument, therefore, does not necessarily undercut his argument, but it does highlight his relatively weak definition of women’s empowerment, which, while certainly driven by the realities on the ground in Chechnya, perhaps deserves further examination. 

Finally, regarding comparisons between Chechnya and neighboring Ingushetia, Lazarev argues generally that “comparative analysis at the macro level indicates no comparable gender differences in legal preferences in Ingushetia. Thus, the results of my analyses converge to show that conflict in Chechnya disrupted gender hierarchies.” However, while Chechens and Ingush are indeed very similar ethnically, a history of conflict was by no means the only thing dividing Ingushetia and Chechnya at the time that this paper was published. Chechnya was (and still is) led by Ramzan Kadyrov, who, as Lazarev mentions in his piece, actively promotes a conservative Islamic lifestyle mixed with a healthy dose of machismo. Ingushetia, on the other hand, had a very different leadership situation, which Lazarev left out: Then-head of Ingushetia Yunus-Bek Evkurov was an ex-military man who generally acted as the Kremlin dictated and certainly did not go out of his way to post masculine workout videos on social media or actively promote conservative Islam. While non-state law definitely has its place in Ingush society, its promotion is less intimately tied to hypermasculinity as in Chechnya, where Ramzan Kadyrov ensures that the two are inextricably intertwined. Furthermore, an in-depth study of women’s legal organ choices in family law matters in Ingushetia by Izabella Evloeva in 2019 (after this article was published) shows that in Ingushetia, gender's role in legal choice has many layers. Evloeva argues that mothers often tend to *prefer* sharia courts in family matters, [@Ingush] implying that Ingushetia and Chechnya's sharia courts are fundamentally different. At the same time, she argues that many women have been petitioning Ingush state courts of late, showing that Ingush state courts are also starting to become preferred organs for women, even without a history of conflict. Clearly, there is more nuance to the Ingushetia-Chechnya comparison that meets the eye.

#### Data critiques:

One critique that I have for Lazarev’s data is regarding his treatment of Chechnya’s geography. On page 680, Lazarev notes in a footnote that his analysis excludes a few mountainous regions of Chechnya, stating that they are “mostly uninhabited mountainous areas.” While Lazarev is not wrong that these areas have very few people, I wonder about what would happen if they were included in the data: after all, these regions have been much more important in Chechnya’s recent history than their low populations would imply, as some of them are well-known as being a main source of anti-state sentiments: Sharoy rayon, for example, was a hiding place for many Islamist rebels during the wars. 

Additionally, regarding variable choice, I think that altitude is a much more important variable here than “distance from Groznyy.” Altitude really matters – the culture of mountainous Chechnya is much different than that of lowland Chechnya. Distance from Groznyy, on the other hand, is in my opinion a somewhat weak variable. Lazarev’s idea is that Groznyy was the area that all forces were pushing to control, thereby making it the epicenter of conflict. But the conflict was unequally spread: Throughout the course of the war, a lot of areas that are near Groznyy were nearly untouched by the war, because they were occupied by forces loyal to the federal center from very close to the beginning. The Kadyrov clan hails from Kurchaloi rayon and controlled Gudermes along with the Yamadaev family, thereby ensuring safety for these areas, as both families allied with the Russian center early on in the Second Chechen War. These areas are quite close to Groznyy – only about 25 miles away. Meanwhile, a lot of northern Chechnya (significantly farther from Groznyy) was hit significantly less hard. Furthermore, equidistant parts of northern and southern Chechnya were affected in very different ways by the war—the southern mountains acted as much more of a hideout than the northern steppes. I am not confident that “distance from Groznyy” is a particularly useful variable, and I think that the altitude variable that Lazarev uses is significantly more important.

Thirdly, there were 106,000 court cases in magistrates’ courts in Chechnya from 2010-2016. He only used 9,000 of them, in which the plaintiff was a natural person. Of these, 60% were family-oriented. Among family-oriented cases in this time period, perhaps Lazarev’s data holds strong. But the fact that Lazarev only applies his findings to around 5% of Chechnya’s court cases, it is worth questioning how broadly applicable this data is.  

Finally, there are a few smaller areas that I believe should be explored further. For one, there is vast heterogeneity in age, location, and other factors among women that is worth analyzing. Also, Lazarev only Chechnya and Ingushetia through his indexRL variable (Russian law), and not for indexS or indexA. It would be interesting to see how these variables are connected as well. 

#### Conclusion

Overall, Lazarev does an excellent job with his data, and his code is easily replicable and provides the same results shown in his paper. I believe that this article was well-researched, and the broader conclusions are interesting, applicable and should be taken seriously. However, there are a few areas in which I believe that the article could improve, which this section has highlighted and expanded upon.

\pagebreak
# Tables and Figures

This section shows my replications of Lazarev's graphs and tables. This page displays a series of graphs that show up as Figure 2 in the article. I used the ggarrange() function in the ggpubr package.
```{r include = FALSE}
figdat <- read.csv2("raw-data/wp_data_raw.csv")
```

```{r, fig.width = 10, fig.height = 11}
h1 <- ggplot(data=figdat[!is.na(figdat$Q1),], 
             aes(factor(Q1))) + 
  geom_bar(aes(y = (..count..)/sum(..count..)),
           fill=("grey69"), position = "dodge") + 
  geom_text(aes(y = ((..count..)/sum(..count..)), 
                label = round((..count..)/sum(..count..), digits = 2)), 
            stat = "count", vjust = -0.25, size = 8) +
  scale_y_continuous(limits=c(0, .8)) +
  scale_x_discrete(labels=c("1" = "State Law","2" = "Sharia","3" = "Adat", "4" = "Don't Know")) +
  labs(title = "Child Custody",
       y = "Share",
       x = "")

h2 <- ggplot(data=figdat[!is.na(figdat$Q3_graph),], 
             aes(factor(Q3_graph))) + 
  geom_bar(aes(y = (..count..)/sum(..count..)),
           fill=("grey69"), position = "dodge") + 
  geom_text(aes(y = ((..count..)/sum(..count..)), 
                label = round((..count..)/sum(..count..), digits = 2)), 
            stat = "count", vjust = -0.25, size = 8) +
  scale_y_continuous(limits=c(0, .8)) +
  scale_x_discrete(labels=c("1" = "State Law","2" = "Sharia","3" = "Adat", "4" = "Don't Know")) +
  labs(title = "Domestic Violence",
       y = "Share",
       x = "")

h3 <- ggplot(data=figdat[!is.na(figdat$Q5_graph),], 
             aes(factor(Q5_graph))) + 
  geom_bar(aes(y = (..count..)/sum(..count..)),
           fill=("grey69"), position = "dodge") + 
  geom_text(aes(y = ((..count..)/sum(..count..)), 
                label = round((..count..)/sum(..count..), digits = 2)), 
            stat = "count", vjust = -0.25, size = 8) +
  scale_y_continuous(limits=c(0, .8)) +
  scale_x_discrete(labels=c("1" = "State Law","2" = "Sharia","3" = "Adat", "4" = "Don't Know")) +
  labs(title = "Bride Kidnapping",
       y = "Share",
       x = "")

h4 <- ggplot(data=figdat[!is.na(figdat$Q8_graph),], 
             aes(factor(Q8_graph))) + 
  geom_bar(aes(y = (..count..)/sum(..count..)),
           fill=("grey69"), position = "dodge") + 
  geom_text(aes(y = ((..count..)/sum(..count..)), 
                label = round((..count..)/sum(..count..), digits = 2)), 
            stat = "count", vjust = -0.25, size = 8) +
  scale_y_continuous(limits=c(0, .8)) +
  scale_x_discrete(labels=c("1" = "State Law","2" = "Sharia","3" = "Adat", "4" = "Don't Know")) +
  labs(title = "Honor Killing",
       y = "Share",
       x = "")

h5 <- ggplot(data=figdat[!is.na(figdat$Q10),], 
             aes(factor(Q10))) + 
  geom_bar(aes(y = (..count..)/sum(..count..)),
           fill=("grey69"), position = "dodge") + 
  geom_text(aes(y = ((..count..)/sum(..count..)), 
                label = round((..count..)/sum(..count..), digits = 2)), 
            stat = "count", vjust = -0.25, size = 8) +
  scale_y_continuous(limits=c(0, .8)) +
  scale_x_discrete(labels=c("1" = "State Law","2" = "Sharia","3" = "Adat", "4" = "Don't Know")) +
  labs(title = "Polygamy",
       y = "Share",
       x = "")

h6 <- ggplot(data=figdat[!is.na(figdat$Q12),], 
             aes(factor(Q12))) + 
  geom_bar(aes(y = (..count..)/sum(..count..)),
           fill=("grey69"), position = "dodge") + 
  geom_text(aes(y = ((..count..)/sum(..count..)), 
                label = round((..count..)/sum(..count..), digits = 2)), 
            stat = "count", vjust = -0.25, size = 8) +
  scale_y_continuous(limits=c(0, .8)) +
  scale_x_discrete(labels=c("1" = "State Law","2" = "Sharia","3" = "Adat", "4" = "Don't Know")) +
  labs(title = "Inheritance",
       y = "Share",
       x = "")

h7 <- ggplot(data=figdat[!is.na(figdat$Q14),], 
             aes(factor(Q14))) + 
  geom_bar(aes(y = (..count..)/sum(..count..)),
           fill=("grey69"), position = "dodge") + 
  geom_text(aes(y = ((..count..)/sum(..count..)), 
                label = round((..count..)/sum(..count..), digits = 2)), 
            stat = "count", vjust = -0.25, size = 8) +
  scale_y_continuous(limits=c(0, .8)) +
  scale_x_discrete(labels=c("1" = "State Law","2" = "Sharia","3" = "Adat", "4" = "Don't Know")) +
  labs(title = "Property",
       y = "Share",
       x = "")

h8 <- ggplot(data=figdat[!is.na(figdat$Q16),], 
             aes(factor(Q16))) + 
  geom_bar(aes(y = (..count..)/sum(..count..)),
           fill=("grey69"), position = "dodge") + 
  geom_text(aes(y = ((..count..)/sum(..count..)), 
                label = round((..count..)/sum(..count..), digits = 2)), 
            stat = "count", vjust = -0.25, size = 8) +
  scale_y_continuous(limits=c(0, .8)) +
  scale_x_discrete(labels=c("1" = "State Law","2" = "Sharia","3" = "Adat", "4" = "Don't Know")) +
  labs(title = "Car Accident",
       y = "Share",
       x = "")

h9 <- ggplot(data=figdat[!is.na(figdat$Q18),], 
             aes(factor(Q18))) + 
  geom_bar(aes(y = (..count..)/sum(..count..)),
           fill=("grey69"), position = "dodge") + 
  geom_text(aes(y = ((..count..)/sum(..count..)), 
                label = round((..count..)/sum(..count..), digits = 2)), 
            stat = "count", vjust = -0.25, size = 8) +
  scale_y_continuous(limits=c(0, .8)) +
  scale_x_discrete(labels=c("1" = "State Law","2" = "Sharia","3" = "Adat", "4" = "Don't Know")) +
  labs(title = "Debt",
       y = "Share",
       x = "")

h10 <- ggplot(data=figdat[!is.na(figdat$Q20),], 
              aes(factor(Q20))) + 
  geom_bar(aes(y = (..count..)/sum(..count..)),
           fill=("grey69"), position = "dodge") + 
  geom_text(aes(y = ((..count..)/sum(..count..)), 
                label = round((..count..)/sum(..count..), digits = 2)), 
            stat = "count", vjust = -0.25, size = 8) +
  scale_y_continuous(limits=c(0, .8)) +
  scale_x_discrete(labels=c("1" = "State Law","2" = "Sharia","3" = "Adat", "4" = "Don't Know")) +
  labs(title = "Murder",
       y = "Share",
       x = "")

ggarrange(h1, h2, h3, h4, h5, h6, h7, h8, h9, h10,
          ncol = 2, nrow = 5)
```
*This series of graphs shows preferences for alternative legal systems according to the type of situation. This graphic is simply meant to show that there is a wide array of preferences as to what legal organs to choose, depending on the situation. People tend to prefer sharia in hypothetical disputes, especially in family matters. State law tends to deal more with things like murder, property rights and so on. Adat is associated with more traditional customs.*

This next graphic is labeled as Figure 3 in Lazarev's code.

```{r graphic, message = FALSE, warning = FALSE}
# I commented out this whole code in my Milestone-3.Rmd in the Figure 3 section. I made a few changes for the purposes of this assignment, which I have indicated in this code chunk. 

fig3dat <- read.csv2("raw-data/upd_wp_data_survey.csv")

range01 <- function(x) {(x - min(x))/(max(x) - min(x))}

require(plyr)
length2 <- function (x, na.rm=FALSE) {
  if (na.rm) sum(!is.na(x))
  else       length(x)
}

if (!require(pacman)) install.packages("pacman")

pacman::p_load(readr, ggplot2, plyr, dplyr, magrittr, tidyr, purrr, ggthemes)

means1 <- round(tapply(fig3dat$indexRL, fig3dat$female, mean, na.rm = T), digits=3)
sds1 <- round(tapply(fig3dat$indexRL, fig3dat$female, sd, na.rm = T), digits=3)
n1 <- tapply(fig3dat$indexRL, fig3dat$female, length2, na.rm = T)

se1 <- round(sds1/sqrt(n1), digits=3)

error1 <- round((qt(0.975,df=n1-1)*se1), digits = 3)

min <- c(0,1)
object1 <- c(1,1)

means2 <- round(tapply(fig3dat$indexS, fig3dat$female, mean, na.rm = T), digits=3)
sds2 <- round(tapply(fig3dat$indexS, fig3dat$female, sd, na.rm = T), digits=3)
n2 <- tapply(fig3dat$indexS, fig3dat$female, length2, na.rm = T)
se2 <- round(sds2/sqrt(n2), digits=3)
error2 <- round((qt(0.975,df=n2-1)*se2), digits = 3)
object2 <- c(2,2)

means3 <- round(tapply(fig3dat$indexA, fig3dat$female, mean, na.rm = T), digits=3)
sds3 <- round(tapply(fig3dat$indexA, fig3dat$female, sd, na.rm = T), digits=3)
n3 <- tapply(fig3dat$indexA, fig3dat$female, length2, na.rm = T)
se3 <- round(sds3/sqrt(n3), digits=3)
error3 <- round((qt(0.975,df=n3-1)*se3), digits = 3)
object3 <- c(3,3)

V1_dat <- rbind(cbind(object1, min, means1, sds1, n1, se1, error1, deparse.level=0),
                cbind(object2, min, means2, sds2, n2, se2, error2, deparse.level=0),
                cbind(object3, min, means3, sds3, n3, se3, error3, deparse.level=0))

rownames(V1_dat) <- c(1:6) 
colnames(V1_dat) <- c("sum", "min", "put", "sds", "n", "se", "error") 
sb <- as.data.frame(V1_dat)

sb2 <- sb

sb2$min <- as.factor(sb2$min) 
sb2$sum <- as.factor(sb2$sum)
levels(sb2$sum) <- c("State Law", "Sharia", "Adat") 

figure3 <- ggplot(sb2, aes(x=sum, y=put, fill = min)) + 
  geom_bar(position=position_dodge(), 
           stat="identity", size=.3) + 
  geom_errorbar(aes(ymin=put-error, ymax=put+error),
                size=.5,    
                width=.3,
                position=position_dodge(.9)) +
  
# Added titles and axis labels, changed to labs() instead of xlab(), ylab() and ggtitle()
  
  labs(title = "FIGURE 3: How Gender Impacts Choice of Legal System",
       subtitle = "Data From Lazarev, 'Laws in Conflict: Legacies of War, Gender, and Legal Pluralism in Chechnya'",
       x = "Legal System",
       y = "Mean of Index",
       caption = "This data is taken from surveys performed by Lazarev during fieldwork. Indexes are calculated by averaging \nthe number of scenarios where participants respond that they would choose one form of law over another. Lazarev's \ndata shows gender-based trends in choice of legal structure in Chechnya. The graph shows how men and women \ndiffer in their respective likelihoods to choose Russian state law, sharia, and adat. Women are much more likely \nto choose Russian law than men are, while men are somewhat more likely to choose sharia or adat. The error \nbars are included as well to show the uncertainty around the means.") +
  coord_cartesian(ylim=c(0, .5))+  
  scale_y_continuous(breaks=seq(0, 0.5, .1)) +
  scale_fill_manual(name="Gender", 
                    breaks=c("0", "1"), 
                    labels=c("Male", 
                             "Female"),
                    
# Capitalized legend labels

                    values=c("cornsilk3", "gray33")) +
  theme(text = element_text(size = 10),
        
# Changed text size
        
  axis.line = element_line(colour = "black"),

# Kept axis title

        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank(),
  plot.caption = element_text(hjust = 0.5))

figure3
```
\pagebreak

This next figure is labeled as Table 2 in the article. 

```{r include = FALSE}
upd_data <- read.csv2("raw-data/upd_wp_data_survey.csv")

l1 <- lm(indexRL ~ killed + wounded + damaged + displaced + female + 
           as.factor(age_cohorts) + incomefull + edufull + unemployed + urban_com, data=upd_data) 
summary(l1) 

l2 <- lm(indexS ~ killed + wounded + damaged + displaced + female + 
           as.factor(age_cohorts) + incomefull + edufull + unemployed + urban_com, data=upd_data) 
summary(l2) 

l3 <- lm(indexA ~ killed + wounded + damaged + displaced + female + 
           as.factor(age_cohorts) + incomefull + edufull + unemployed + urban_com, data=upd_data) 
summary(l3) 
```

```{r table2, results = "asis"}
stargazer(l1, l2, l3, title="OLS Regression Analysis of the Impact of Victimization on Legal Preferences", 
          type = "latex",
          header = FALSE)
```

*This table confirms and expands upon the data presented in FIGURE 3. The coefficients corresponding to the "female" variable correspond to the trends portrayed graphically, showing that being women are significantly more likely to choose state law than men, slightly less likely than men to choose sharia, and significantly less likely to choose adat than men. The table also accounts for other variables: if an individual had a relative killed or wounded, if the person has been displaced, and other variables. The regression table also shows how income, education, unemployment and urbanity affect choice of one law style over another.*

This next table was labeled as Table 3 in the article.

```{r tab3prep, include = FALSE}
k1 <- lm(indexRL ~ com_exposure*female + 
           as.factor(age_cohorts) + incomefull + edufull + unemployed + urban_com + 
           russ_pop + lmaltitude + ldistance_Grozny + lcom_size + as.factor(rayon), data = upd_data)
summary(k1)

k1_vcov <- cluster.vcov(k1, upd_data$location)

coeftest(k1, vcov. = k1_vcov)

cluster_se <- sqrt(diag(cluster.vcov(k1, upd_data$location)))

k2 <- lm(indexS ~ com_exposure*female + 
           as.factor(age_cohorts) + incomefull + edufull + unemployed + urban_com + 
           russ_pop + lmaltitude + ldistance_Grozny + lcom_size + as.factor(rayon), data = upd_data)
summary(k2)

k2_vcov <- cluster.vcov(k2, upd_data$location)

coeftest(k2, vcov. = k2_vcov)

cluster_se <- sqrt(diag(cluster.vcov(k2, upd_data$location)))

k3 <- lm(indexA ~ com_exposure*female + 
           as.factor(age_cohorts) + incomefull + edufull + unemployed + urban_com + 
           russ_pop + lmaltitude + ldistance_Grozny + lcom_size + as.factor(rayon), data = upd_data)
summary(k3)

k3_vcov <- cluster.vcov(k3, upd_data$location)

coeftest(k3, vcov. = k3_vcov)

cluster_se <- sqrt(diag(cluster.vcov(k2, upd_data$location)))

```

```{r tab3, results = "asis"}

stargazer(k1, k2, k3, se = list(coeftest(k1, vcov. = k1_vcov)[,2],
                                coeftest(k2, vcov. = k2_vcov)[,2],
                                coeftest(k3, vcov. = k3_vcov)[,2]),
          title = "OLS Regression Analysis of the Effect of Community Victimization and Gender on Legal Preferences",
          type = "latex",
          header = FALSE,
          keep = c("\\bcom_exposure\\b", "\\bfemale\\b", "\\bConstant\\b"))

# Formatted to make it look more like his table

```
*This table moves the narrative toward Lazarev's next argument, namely, that the pattern of women choosing to turn to state courts for legal disputes rather than sharia or customary courts is exacerbated  by the level to which a region was aﬀected by violence during the Chechen wars. Conﬂict provided women with more opportunity to pursue their interests through oﬃcial law. The table shows that when a given person is female and lives in a community affected by violence, the person is 6 percent more likely to choose state law, and almost 7 percent less likely to choose sharia (with a certain degree of error). Both of these numbers show how the conflict experience, in Lazarev's view, plays a role in gendered legal choice.*

\pagebreak
This next graph is Figure 5, showing differences in victimization and nonvictimization. 

```{r include = FALSE}
fig5data <- read.csv2("raw-data/upd_wp_data_survey.csv")

fig5data$victimized[fig5data$com_exposure=='0']<-'nonvictimized'
fig5data$victimized[fig5data$com_exposure=='1']<-'victimized'

fig5data$gender[fig5data$female=='0']<-'male'
fig5data$gender[fig5data$female=='1']<-'female'

m1 <- lm(indexRL ~ victimized*gender + 
           as.factor(age_cohorts) + incomefull + edufull + unemployed + urban_com +
           russ_pop + lmaltitude + ldistance_Grozny + lcom_size, data = fig5data)
summary(m1)

figure5 <- cat_plot(m1, pred = victimized, modx = gender, geom = "bar") + 
  labs(x="", y = "", title = "FIGURE 5: Interaction Plot for the Effects of Community \nVictimization and Gender on Support for State Law",
       caption = "This plot shows the difference in the gender split regarding support for state law between \ncommunities that were victimized and not victimized by violence. In communities victimized by \nviolence, Lazarev shows that women are much more likely to choose state law than men are, and the \ndivide between genders is significantly greater than the divide in communities that have not been \nvictimized by violence. This graph corresponds with Table 3, which shows the interaction \nbetween the 'com_exposure' variable and the 'female' variable. Not only is Lazarev arguing that \nwomen are more likely to choose state law than men -- he is also showing that being exposed to \nviolence has an effect as well, as split is wider in victimized areas than non-victimized ones. \nThis, in his eyes, shows support for the idea that much of the split is due to conflict.") +
  scale_color_manual("gender", values=c('grey20','grey60'))+
  scale_fill_manual("gender",values=c('grey30','grey80')) +
  theme(plot.caption = element_text(hjust = 0.5))
``` 

```{r}
figure5
```

\pagebreak
This table was originally labeled as Table 3 in Lazarev's code; in the paper, it is labeled as Table 4.

```{r include = FALSE}
reg_data <- read.csv2("raw-data/wp_data_courts.csv")

# I changed the name of the data from his original. I also put include = FALSE so that this all would not show up in the PDF, but I could make a table out of it. 

famdata <- reg_data[which(reg_data$family==1),]
nonfamdata <- reg_data[which(reg_data$family==0),]

m1 <- glm(istez_females ~ com_exposure + urban +
            mountainous + russ_pop + pop_fem_share + 
            as.factor(year),family=binomial(link='logit'),data = reg_data)
summary(m1)

m1_vcov <- cluster.vcov(m1, reg_data$uchastok)

coeftest(m1, vcov. = m1_vcov)

cluster_se <- sqrt(diag(cluster.vcov(m1, reg_data$uchastok)))

stargazer(m1, se = list(coeftest(m1, vcov. = m1_vcov)[,2]), 
          omit.stat = c("rsq", "f", "adj.rsq", "ser"))

m2 <- glm(istez_females ~ com_exposure + urban +
            mountainous + russ_pop + pop_fem_share + 
            as.factor(year),family=binomial(link='logit'),data=famdata)
summary(m2)

m2_vcov <- cluster.vcov(m2, famdata$uchastok)

coeftest(m2, vcov. = m2_vcov)

cluster_se <- sqrt(diag(cluster.vcov(m2, famdata$uchastok)))

m3 <- glm(istez_females ~ com_exposure + urban +
            mountainous + russ_pop + pop_fem_share + 
            as.factor(year),family=binomial(link='logit'),data=nonfamdata)
summary(m3)

m3_vcov <- cluster.vcov(m3, nonfamdata$uchastok)

coeftest(m3, vcov. = m3_vcov)

cluster_se <- sqrt(diag(cluster.vcov(m3, nonfamdata$uchastok)))
```

```{r tab4, results = "asis"}
stargazer(m1, m2, m3, se = list(coeftest(m1, vcov. = m1_vcov)[,2],
                                coeftest(m2, vcov. = m2_vcov)[,2],
                                coeftest(m3, vcov. = m3_vcov)[,2]),
          title = "Predicting Female Plaintiff in Civil Disputes: Binary Logistic Regression",
          type="latex", 
          header = FALSE,
          keep = c("\\bcom_exposure\\b", "\\burban\\b", "\\bmountainous\\b", "\\bruss_pop\\b", "\\bpop_fem_share\\b", "\\bConstant\\b"))
```
*This table shows various predictors for whether or not the plaintiff will be female in a given state law court case ("istez_females" means female plaintiffs). Lazarev takes all court cases over a given postwar period in Chechnya that have an individual plaintiff and separates them into three categories. (1) shows results for all cases, (2) shows results for that subset that deals with "family issues" and (3) deals with the remainder, that is, the cases that are not family-related. Referring to this table, Lazarev argues that "all else being equal, in more victimized communities, the likelihood of having a female plaintiff is significantly higher than in less-victimized ones. Transformation of the logistic regression coefficient suggests that the difference is approximately 12 percentage points, which is substantially large." Lazarev also notes through this graph that simple male/female demographics (labeled as pop_fem_share) do not have predictive power, as error is very high. Thus, Lazarev shows through this table that there is a positive relationship between community victimization and subsequent use of state law by women.*

\pagebreak
This graph compares how men and women view Russian state law in Chechnya and Ingushetia, comparatively.
```{r}
total <- read.csv2("raw-data/wp_data_Chechnya_Ingushetia.csv")

ftotal <- total[which(total$data.female==1),]
mtotal <- total[which(total$data.female==0),]

means1 <- round(tapply(ftotal$data.indexRL, ftotal$chechnya, mean, na.rm = T), digits=3)
sds1 <- round(tapply(ftotal$data.indexRL, ftotal$chechnya, sd, na.rm = T), digits=3)
n1 <- tapply(ftotal$data.indexRL, ftotal$chechnya, length2, na.rm = T)
se1 <- round(sds1/sqrt(n1), digits=3)
error1 <- round((qt(0.975,df=n1-1)*se1), digits = 3)
min <- c(0,1)
object1 <- c(1,1)

means2 <- round(tapply(mtotal$data.indexRL, mtotal$chechnya, mean, na.rm = T), digits=3)
sds2 <- round(tapply(mtotal$data.indexRL, mtotal$chechnya, sd, na.rm = T), digits=3)
n2 <- tapply(mtotal$data.indexRL, mtotal$chechnya, length2, na.rm = T)
se2 <- round(sds2/sqrt(n2), digits=3)
error2 <- round((qt(0.975,df=n2-1)*se2), digits = 3)
min <- c(0,1)
object2 <- c(2,2)

V1_dat <- rbind(cbind(object1, min, means1, sds1, n1, se1, error1, deparse.level=0),
                cbind(object2, min, means2, sds2, n2, se2, error2, deparse.level=0))

rownames(V1_dat) <- c(1:4) 
colnames(V1_dat) <- c("sum", "min", "put", "sds", "n", "se", "error") 
sb <- as.data.frame(V1_dat)

sb2 <- sb
sb2$min <- as.factor(sb2$min) 
sb2$sum <- as.factor(sb2$sum)
levels(sb2$sum) <- c("Women", "Men") 

figure6 <- ggplot(sb2, aes(x=sum, y=put, fill = min)) + 
  geom_bar(position=position_dodge(), 
           stat="identity", size=.3) +      
  geom_errorbar(aes(ymin=put-error, ymax=put+error),
                size=.5,    # Thinner lines
                width=.3,
                position=position_dodge(.9)) +
  xlab("") +
  ylab("") +
  ggtitle("Gender Gaps in Support for State Law in Chechnya and Ingushetia") +
  labs(caption = "This graph shows the final aspect of Lazarev's analysis -- his comparison of choices of Russian \nlaw by gender between Chechnya and Ingushetia. In Chechnya, we see that significantly more women than men \nchoose Russian state law, while in Ingushetia, this pattern is not present: in fact, by Lazarev's analysis, \nmen seem a bit more likely to choose state law than women. Lazarev describes Ingushetia and Chechnya as \nalmost identical regions -- except for Chechnya's conflict experience. He therefore uses this analysis to \nback up his point that conflict experience has exacerbated gender splits, as in his view, conflict is \nthe only major factor dividing Ingushetia and Chechnya.") +
  coord_cartesian(ylim=c(0, .5))+  
  scale_y_continuous(breaks=seq(0, 0.5, .1)) +
  scale_fill_manual(name="Region", # Legend label, use darker colors
                    # breaks=c("1", "2", "3"),
                    breaks=c("0", "1"), 
                    labels=c("Ingushetia", 
                             "Chechnya"),
                    values=c("gray88", "grey44")) +
  theme(text = element_text(size=10),
        axis.line = element_line(colour = "black"),
        axis.title.x = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        plot.caption = element_text(hjust = 0.5))
figure6
```

# Appendix 

Results from Lazarev (2019) were successfully replicated. For code details, see the .Rmd for this paper, located in my GitHub repository at https://github.com/dfshapir/Replication.

```{r dataman, eval = FALSE}
data <- read.csv2("raw-data/wp_data_raw.csv")
stargazer(data)

## This package essentially converts the csv into a table you can copy into Microsoft Word and edit.
```

```{r indexfun, eval = FALSE}

## This first section here defines indexes and pares down data into more usable forms. The recode_dummy function is meant to help recoding the other variables.  

recode_dummy <- function(.df, 
                         .name_q,
                         .val) {
  
# If a value in a given column of a dataframe is not NA or not NOT the given value, it gets recoded as 1, otherwise, it becomes 0.
  
  return(ifelse(test = (.df[,.name_q] != .val | is.na(.df[, .name_q])), 
                yes = 0, 
                no = 1))
}

# 

data$V1RL <- recode_dummy(.df = data, 
                          .name_q = "Q1", 
                          .val = 1)

# Creates the variable names for future use in the below for loops by pasting a Q before a number, given by 1, 3, 5, and then a sequence by twos from 8 to 22. 

varnames <- paste0("Q", c(1,3,5,seq(8,22,2)))


## Loop for RL (Russian Law)

for (i in 1:10) {
  
# .name_dummy is defined as a variable name in which "V" has been pasted before the number, then RL. There will be 10 columns. For those columns, the recode_dummy is run on it to see if it has the value of 1. 1 signifies Russian Law. It gets recoded as 1 in the new column if the value in the old column is 1, and as 0 if not.
  
  .name_dummy <- paste0("V",i,"RL")
  data[,.name_dummy] <- recode_dummy(.df = data, 
                                     .name_q = varnames[i], 
                                     .val = 1)
}


## Loop for Sharia 

for (i in 1:10) {
  
# .name_dummy is defined as a variable name in which "V" has been pasted before the number, then S. There will be 10 columns. For those columns, the recode_dummy is run on it to see if it has the value of 2. 2 signifies Sharia. It gets recoded as 1 in the new column if the value in the old column is 2, and as 0 if not. 

  .name_dummy <- paste0("V",i,"S")
  data[,.name_dummy] <- recode_dummy(.df = data, 
                                     .name_q = varnames[i], 
                                     .val = 2)
}


## Loop for Adat 

for (i in 1:10) {
  
# .name_dummy is defined as a variable name in which "V" has been pasted before the number, then A. There will be 10 columns. For those columns, the recode_dummy is run on it to see if it has the value of 3. 3 signifies Adat. It gets recoded as 1 in the new column if the value in the old column is 3, and as 0 if not. 
  
  .name_dummy <- paste0("V",i,"A")
  data[,.name_dummy] <- recode_dummy(.df = data, 
                                     .name_q = varnames[i], 
                                     .val = 3)
}



##### INDEX for preference for Russian Law

data$indexRL<-NA

# Lazarev creates a new column, called indexRL (in a non-tidyverse manner). indexRL is created by adding together all of the previously-created variables that end in RL and dividing them by 10 (the number of variables that would be created, given that the for loop was meant to be from 1:10). He then creates a histogram for them to show the distribution of values. 

data$indexRL <- (data$V1RL + data$V2RL + data$V3RL + data$V4RL + data$V5RL +
                   data$V6RL + data$V7RL + data$V8RL + data$V9RL + data$V10RL)/10

hist(data$indexRL)

##### INDEX for preference for Sharia

# The same process is repeated for Sharia.

data$indexS<-NA
data$indexS <- (data$V1S + data$V2S + data$V3S + data$V4S + data$V5S +
                  data$V6S + data$V7S + data$V8S + data$V9S + data$V10S)/10
hist(data$indexS)

##### INDEX for preference for Adat

# The same procedure is repeated for Adat.

data$indexA<-NA
data$indexA <- (data$V1A + data$V2A + data$V3A + data$V4A + data$V5A +
                  data$V6A + data$V7A + data$V8A + data$V9A + data$V10A)/10
hist(data$indexA)
```

```{r agecoh, eval = FALSE}

# In this code chunk, the author sets the contents of the age_cohorts column to reflect ranges defined by the author. So 17-29 is "youth", 30-49 is "midage" and 50-83 is "older."

data$age_cohorts <- NA
data$age_cohorts[data$age > 17 & data$age < 30]<- "youth"
data$age_cohorts[data$age > 29 & data$age < 50]= "midage"
data$age_cohorts[data$age > 49 & data$age < 83]= "older"
```

```{r imput, eval = FALSE}
# The author loads various useful packages, including the Harrell Miscellaneous package (Hmisc), which has a treasure trove of random functions for various aspects of coding, including for imputation. The mi package (Missing Data Imputation and Model Checking) is more well-tuned for imputation, as the description suggests.

library(mi)
library(Hmisc)
```

```{r educa, eval = FALSE}
# Here, the author makes a new dataframe entitled datax out of some of the columns from the "data" dataframe that he had read in and edited earlier. Specifically, he takes the edu, female, age, urban, urban_Soviet, knowRL, and unemployed variables. 

x<-cbind(data$edu,data$female,data$age,data$urban, data$urban_Soviet, data$knowRL, data$unemployed)
datax<-as.data.frame(x)

# The author has to figure out how to deal with missing data. So he uses the missing_data.frame() call to prepare the data for multiple imputation, which he does by calling the mi() command. The complete() call completes the process (1 being the number of multiply imputed data frames to return) so that he has a new dataframe that he can work with later, called newdata. I had to define the complete() call as mi::complete, because there is an identical call in the tidyr package that does not understand how to work with multiple imputation, and that was being used as the default. I have used this method in other similar areas of the code as well. He then saves the imputed V1 column (a column that previously had missing data) as the edufull column in the original data set.  

mdf<-missing_data.frame(datax)
imp.mi<-mi(mdf)
newdata<-mi::complete(imp.mi,m=1)

data$edufull<-newdata$V1
```

```{r incom, eval = FALSE}

# Here the author uses the exact same code as the previous one, except that he includes a few other variables that are more related to income, apparently, including the recently created edufull column. At the end of this excersive, he writes a new csv over the old csv with the same title. I moved the file to the raw-data area so that I could read it back in again. 

x<-cbind(data$income, data$edufull, data$female, data$age,data$urban, data$official, data$unemployed)
datax<-as.data.frame(x)
mdf<-missing_data.frame(datax)
imp.mi<-mi(mdf)
newdata<-mi::complete(imp.mi,m=1)

data$incomefull<-newdata$V1

write.csv2(data, file = "raw-data/upd_wp_data_survey.csv")

# I changed the name of the rewritten file so that I could keep an original copy and an edited one. 
```

```{r eval = FALSE}
# Here, he re-reads in the csv which he has edited. I assume that the analysis section was originally done in a different document, so it was necessary to overwrite the old csv in the previous bit of code to simply read it back in again in the next one. I, however, have already saved it to a different name to avoid confusion. 

upd_data <- read.csv2("raw-data/upd_wp_data_survey.csv")
```

```{r tablitsa1, eval = FALSE}
# The author constructs a series of regressions, aimed to elucidate each variable's effect on the predefined tendencies to prefer either Russian law (indexRL), sharia law (indexS), or adat (indexA). By running the regressions, the author shows that the "female" variable is by far the most robust of the tested variables for indexRL (Russian law). Many of the other variables for this regression tell us absolutely nothing -- the standard error for many is greater in absolute value than the actual estimate itself. All of the data shown in these regressions here are then put into a copyable table form by stargazer() and shown later. **NOTE** this chunk, while labeled as "table 1" is actually shown in the article as Table 2. It is also worth noting that the regressions here published slightly different numbers than shown in Lazarev's table. The general trends are still the same and the numbers are almost the same, so Lazarev is not wrong, per se.

m1 <- lm(indexRL ~ killed + wounded + damaged + displaced + female + 
           as.factor(age_cohorts) + incomefull + edufull + unemployed + urban_com, data=upd_data) 
summary(m1) 

# The second regression is set up in the same way. 

m2 <- lm(indexS ~ killed + wounded + damaged + displaced + female + 
           as.factor(age_cohorts) + incomefull + edufull + unemployed + urban_com, data=upd_data) 
summary(m2) 

# In this regression, the data shown by the summary indicates that being part of the "older" age grouping (as created earlier, defined by ages 50-83) has the most significant impact on likelihood to prefer customary law. This makes a certain amount of sense, given the traditional nature of adat.

m3 <- lm(indexA ~ killed + wounded + damaged + displaced + female + 
           as.factor(age_cohorts) + incomefull + edufull + unemployed + urban_com, data=upd_data) 
summary(m3) 
stargazer(m1, m2, m3, title="OLS Regression Analysis of the Impact of Victimization on Legal Preferences", align=TRUE, no.space=TRUE)

stargazer(m1, m2, m3, title="OLS Regression Analysis of the Impact of Victimization on Legal Preferences", align=TRUE, no.space=TRUE,
          type="html",
          out="table1.doc")

# I understand that Lazarev did not focus so much on determinants for preferring other forms of law, because it is not his main argument, but these in themselves are worth exploring further, even though they only really confirm the pre-existing literature. For one, focusing on sharia as more than just "patriarchal," but also as a tool directed toward the less-well-off, would be interesting and useful. 
```

```{r tablitsa2, eval = FALSE}

# This set of regressions is meant to address the problem of victimization at the community level. By putting one of the variables as com_exposure*female, Lazarev estimates the effect of the interaction between community victimization and gender on the choice of law. m1 represents the effect on choice of Russian state law, m2 represents the effect on choice of sharia, and m3 represents the effect on choice of adat. In the regressions, there are coefficients for the com_exposure and female variables separately, as well as the interaction between the two. He also includes the rayon variable. A "rayon" is essentially the Russian administrative version of something between a municipality and a county -- they're usually smaller than US counties but contain multiple towns. Kurchaloi rayon, for example, would likely also include the town of Geldagan and Mairtup. He does this so that he can properly measure community victimization, as he shows on pages 688 and 689 and in Figure 4. 

# Lazarev explains that there are a lot of difficulties and a lot of factors that go into establishing why a community has been exposed to violence, and he worries about the data being endogenous. So he adds in a couple of other variables that help define geography -- distance from Groznyy (the capital, which everyone was trying to control) and altitude. I think that altitude is a much more important variable here; the culture of mountainous Chechnya is much different than that of lowland Chechnya. Furthermore, in the course of the war, a lot of areas that are near Groznyy were nearly untouched by the war, because they were occupied by forces loyal to the federal center from very close to the beginning. The Kadyrov clan hails from Kurchaloi rayon and controlled Gudermes along with the Yamadayev family, thereby ensuring safety for these areas, as both families allied with the Russian center early on in the Second Chechen War. Both areas were targeted during the First Chechen War, mitigating this security somewhat, but this is an important distinction to make. While Lazarev doesn't analyze these intricacies very closely, the altitude factor (upland Chechnya was poorer and almost entirely rebel-held, while much of the valleys ended up turning toward the center) is definitely important. He adds other variables in here too, such as Russian population. Maybe being exposed to ethnic Russians makes Chechens more or less likely to choose sharia or traditional law. 

m1 <- lm(indexRL ~ com_exposure*female + 
           as.factor(age_cohorts) + incomefull + edufull + unemployed + urban_com + 
           russ_pop + lmaltitude + ldistance_Grozny + lcom_size + as.factor(rayon), data = upd_data)
summary(m1)

# Below, Lazarev clusters his standard errors at the community level. He does this for the other two regressions as well. This is so he can compare men's and women's predispositions toward or against Russian law in victimized versus non-victimized communities. To argue which communities have been "victimized," he explains in his piece that he takes evidence from some personal interviews, including some with NGOs that help tell him which areas have been "victimized" and which were not. He identifies sixteen communities that were targeted in either war and 23 that weren't.

m1_vcov <- cluster.vcov(m1, upd_data$location)

coeftest(m1, vcov. = m1_vcov)

# Gives the coefficients, standard error, z value, etc.

cluster_se <- sqrt(diag(cluster.vcov(m1, upd_data$location)))

# The above code provides the standard error for the coefficients. 

m2 <- lm(indexS ~ com_exposure*female + 
           as.factor(age_cohorts) + incomefull + edufull + unemployed + urban_com + 
           russ_pop + lmaltitude + ldistance_Grozny + lcom_size + as.factor(rayon), data = upd_data)
summary(m2)

m2_vcov <- cluster.vcov(m2, upd_data$location)

coeftest(m2, vcov. = m2_vcov)

cluster_se <- sqrt(diag(cluster.vcov(m2, upd_data$location)))

m3 <- lm(indexA ~ com_exposure*female + 
           as.factor(age_cohorts) + incomefull + edufull + unemployed + urban_com + 
           russ_pop + lmaltitude + ldistance_Grozny + lcom_size + as.factor(rayon), data = upd_data)
summary(m3)

m3_vcov <- cluster.vcov(m3, upd_data$location)

coeftest(m3, vcov. = m3_vcov)

cluster_se <- sqrt(diag(cluster.vcov(m2, upd_data$location)))

stargazer(m1, m2, m3, se = list(coeftest(m1, vcov. = m1_vcov)[,2],
                                coeftest(m2, vcov. = m2_vcov)[,2],
                                coeftest(m3, vcov. = m3_vcov)[,2]),
          type="html",
          out="table2.doc")

# Above, Lazarev puts the results of his regressions into a usable table. For se (standard error), he takes the second column of each. 
```

```{r predval, eval = FALSE}

# In this chunk, Lazarev runs the same regression as in the previous chunk and creates new one-line data frames based on switching out one variable and taking the means for other variables. In newdata1:newdata4, urban_com = 1, meaning that the community is urban, rather than rural. In newdata5:newdata8, urban_com = 0, meaning that the community is rural. newdata1 and newdata5 measure instances where the participant is not female and the community has not been victimized. newdata2 and newdata6 are non-victimized and female, 3 and 7 are victimized and non-female, and 4 and 8 are victimized and female. These are all conglomerated to predict indexRL values given the defined parameters in the various newdata chunks, as defined below. 

m1 <- lm(indexRL ~ com_exposure*female + 
  as.factor(age_cohorts) + incomefull + edufull + unemployed + urban_com +
    russ_pop + lmaltitude + ldistance_Grozny + lcom_size, data = upd_data)
summary(m1)

# Why does Lazarev set age_cohorts to "midage" in everything? I would like to see what would happen to this numbers if age_cohorts is set to something different. 

newdata1 = data.frame(com_exposure = 0, female = 0, age_cohorts = 'midage',
                      incomefull = mean(upd_data$incomefull), edufull = mean(upd_data$edufull),
                      unemployed = 0, urban_com = 1, russ_pop = mean(upd_data$russ_pop), 
                      lmaltitude = mean(upd_data$lmaltitude), ldistance_Grozny = mean(upd_data$ldistance_Grozny),
                      lcom_size = mean(upd_data$lcom_size))

newdata2 = data.frame(com_exposure = 0, female = 1, age_cohorts = 'midage',
                      incomefull = mean(upd_data$incomefull), edufull = mean(upd_data$edufull),
                      unemployed = 0, urban_com = 1, russ_pop = mean(upd_data$russ_pop), 
                      lmaltitude = mean(upd_data$lmaltitude), ldistance_Grozny = mean(upd_data$ldistance_Grozny),
                      lcom_size = mean(upd_data$lcom_size))

newdata3 = data.frame(com_exposure = 1, female = 0, age_cohorts = 'midage',
                      incomefull = mean(upd_data$incomefull), edufull = mean(upd_data$edufull),
                      unemployed = 0, urban_com = 1, russ_pop = mean(upd_data$russ_pop), 
                      lmaltitude = mean(upd_data$lmaltitude), ldistance_Grozny = mean(upd_data$ldistance_Grozny),
                      lcom_size = mean(upd_data$lcom_size))

newdata4 = data.frame(com_exposure = 1, female = 1, age_cohorts = 'midage',
                      incomefull = mean(upd_data$incomefull), edufull = mean(upd_data$edufull),
                      unemployed = 0, urban_com = 1, russ_pop = mean(upd_data$russ_pop), 
                      lmaltitude = mean(upd_data$lmaltitude), ldistance_Grozny = mean(upd_data$ldistance_Grozny),
                      lcom_size = mean(upd_data$lcom_size))


newdata5 = data.frame(com_exposure = 0, female = 0, age_cohorts = 'midage',
                      incomefull = mean(upd_data$incomefull), edufull = mean(upd_data$edufull),
                      unemployed = 0, urban_com = 0, russ_pop = mean(upd_data$russ_pop), 
                      lmaltitude = mean(upd_data$lmaltitude), ldistance_Grozny = mean(upd_data$ldistance_Grozny),
                      lcom_size = mean(upd_data$lcom_size))

newdata6 = data.frame(com_exposure = 0, female = 1, age_cohorts = 'midage',
                      incomefull = mean(upd_data$incomefull), edufull = mean(upd_data$edufull),
                      unemployed = 0, urban_com = 0, russ_pop = mean(data$russ_pop), 
                      lmaltitude = mean(upd_data$lmaltitude), ldistance_Grozny = mean(upd_data$ldistance_Grozny),
                      lcom_size = mean(upd_data$lcom_size))

newdata7 = data.frame(com_exposure = 1, female = 0, age_cohorts = 'midage',
                      incomefull = mean(upd_data$incomefull), edufull = mean(upd_data$edufull),
                      unemployed = 0, urban_com = 0, russ_pop = mean(upd_data$russ_pop), 
                      lmaltitude = mean(upd_data$lmaltitude), ldistance_Grozny = mean(upd_data$ldistance_Grozny),
                      lcom_size = mean(upd_data$lcom_size))

newdata8 = data.frame(com_exposure = 1, female = 1, age_cohorts = 'midage',
                      incomefull = mean(data$incomefull), edufull = mean(upd_data$edufull),
                      unemployed = 0, urban_com = 0, russ_pop = mean(upd_data$russ_pop), 
                      lmaltitude = mean(upd_data$lmaltitude), ldistance_Grozny = mean(upd_data$ldistance_Grozny),
                      lcom_size = mean(upd_data$lcom_size))

# This series of predict() functions forms a major part of Lazarev's argument. Essentially, he uses the linear regression model (m1) and adds the new data in, with the adjusted parameters for female, victimization and urbanity, and then predicts values for what the mean indexRL value will be for all of them. Again, my values are slightly different from Lazarev's values, but the patterns are all the same. Incidentally, the urban/rural divide does not make any real difference on the gender divide in this regression. In general, the final four predictions (with urban_com set to 0) are about 2 points higher across the board. 

predict(m1, newdata1, type = "response")
predict(m1, newdata2, type = "response")
predict(m1, newdata3, type = "response")
predict(m1, newdata4, type = "response")


predict(m1, newdata5, type = "response")
predict(m1, newdata6, type = "response")
predict(m1, newdata7, type = "response")
predict(m1, newdata8, type = "response")
```

```{r tablitsa3, eval = FALSE}
courts_data <- read.csv2("raw-data/wp_data_courts.csv")

# Originally, Lazarev made all of his csv read-ins be entitled "data." To avoid confusion, I changed the names. 

## Last names of plaintiffs are redacted from these data for privacy reasons [LAZAREV NOTE]

# In the below bit of code, Lazarev splits the data frame into two separate dataframes, one where the "family" variable is equal to 1, and one where it is not. The "family" variable indicates if the case is related to family disputes or not. A little over 60% of cases (shown by the 6144 rows in famdata in comparison to 9359 in data) are related.

famdata <- courts_data[which(courts_data$family==1),]
nonfamdata <- courts_data[which(courts_data$family==0),]

# Here, Lazarev sets up another regression, in which he uses "istez_females" as the dependent variable. In Russian, the word "istets" means plaintiff, so this is a variable with 1 where the istets is female, and 0 where the istets is not. He uses the original data (not limited to family cases) for this regression. He sets "family" equal to binomial(link = 'logit') meaning that this is a binomial logistic regression. glm() is used here as compared to lm() in the previous one, because while indexRL was a numeric variable, istez_females is categorical. 

m1 <- glm(istez_females ~ com_exposure + urban +
            mountainous + russ_pop + pop_fem_share + 
            as.factor(year),family=binomial(link='logit'),data=courts_data)
summary(m1)

# The below lines of code are similar to what we've seen earlier, in which he clusters by a geographic indicator. Previously, this was "rayon," referring to a smaller delineation of the region (Chechnya). An "uchastok" refers to the jurisdiction of a certain court. There should be more uchastoks than rayons, but they do correspond to geographic areas. 

m1_vcov <- cluster.vcov(m1, courts_data$uchastok)

coeftest(m1, vcov. = m1_vcov)

cluster_se <- sqrt(diag(cluster.vcov(m1, courts_data$uchastok)))

# All of the above code is almost identical to that of the previous chunk. Below, Lazarev does the same things as he did above for famdata and for nonfamdata. This way, he'll be able to get coefficients for all cases, cases about family issues, and cases that aren't about family issues. 

stargazer(m1, se = list(coeftest(m1, vcov. = m1_vcov)[,2]), 
          omit.stat = c("rsq", "f", "adj.rsq", "ser"))

m2 <- glm(istez_females ~ com_exposure + urban +
            mountainous + russ_pop + pop_fem_share + 
            as.factor(year),family=binomial(link='logit'),data=famdata)
summary(m2)

m2_vcov <- cluster.vcov(m2, famdata$uchastok)

coeftest(m2, vcov. = m2_vcov)

cluster_se <- sqrt(diag(cluster.vcov(m2, famdata$uchastok)))

m3 <- glm(istez_females ~ com_exposure + urban +
            mountainous + russ_pop + pop_fem_share + 
            as.factor(year),family=binomial(link='logit'),data=nonfamdata)
summary(m3)

m3_vcov <- cluster.vcov(m3, nonfamdata$uchastok)

coeftest(m3, vcov. = m3_vcov)

cluster_se <- sqrt(diag(cluster.vcov(m3, nonfamdata$uchastok)))

stargazer(m1, m2, m3, se = list(coeftest(m1, vcov. = m1_vcov)[,2],
                                coeftest(m2, vcov. = m2_vcov)[,2],
                                coeftest(m3, vcov. = m3_vcov)[,2]))


stargazer(m1, m2, m3, se = list(coeftest(m1, vcov. = m1_vcov)[,2],
                                coeftest(m2, vcov. = m2_vcov)[,2],
                                coeftest(m3, vcov. = m3_vcov)[,2]),
          type="html",
          out="table3.doc")
```

```{r predprob, eval = FALSE}

# In this section, Lazarev makes the same sort of predictions as he did in the # Predicted Values section of code. However, he uses the glm() regression from the last code chunk, rather than the lm() from the code chunk before that. Again, he is trying to calculate the effects of various variables on the phenomenon of the plaintiff being a woman, and then using the predict() function to get a "response" of the data-based predicted percentage. For example, the following lines of code use the prior logistic regression, and then fit new data frames on to it where com_exposure (victimization) equals zero or one, and compares how community exposure to atrocities is related to the probability that a plaintiff will be a woman in a family-based case (given that the "family" variable is set equal to one for both newdata1 and newdata2; it is a control variable here) in non-mountainous regions, non-urban regions.

m1 <- glm(istez_females ~ com_exposure + urban + mountainous + russ_pop + pop_fem_share + family + as.factor(year),family=binomial(link='logit'),data=courts_data)
summary(m1)

newdata1 = data.frame(com_exposure = 0, urban = 0, mountainous =0, russ_pop = 0, pop_fem_share = 0.5, family = 1, year = 2013)
newdata2 = data.frame(com_exposure = 1, urban = 0, mountainous =0, russ_pop = 0, pop_fem_share = 0.5, family = 1, year = 2013)

predict(m1, newdata1, type = "response")
predict(m1, newdata2, type = "response")

# The next data change the "mountainous" variable to equal one, so the next predictions do basically the same thing for mountainous, rural regions.

newdata3 = data.frame(com_exposure = 0, urban = 0, mountainous =1, russ_pop = 0, pop_fem_share = 0.5, family = 1, year = 2013)
newdata4 = data.frame(com_exposure = 1, urban = 0, mountainous =1, russ_pop = 0, pop_fem_share = 0.5, family = 1, year = 2013)

predict(m1, newdata3, type = "response")
predict(m1, newdata4, type = "response")

# These predictions measure the same phenomenon, but for urban, non-mountainous areas.

newdata5 = data.frame(com_exposure = 0, urban = 1, mountainous =0, russ_pop = 0, pop_fem_share = 0.5, family = 1, year = 2013)
newdata6 = data.frame(com_exposure = 1, urban = 1, mountainous =0, russ_pop = 0, pop_fem_share = 0.5, family = 1, year = 2013)

predict(m1, newdata5, type = "response")
predict(m1, newdata6, type = "response")

# These predictions measure the same phenomenon as newdata1 and 2, but for non-family-related cases.

newdata7 = data.frame(com_exposure = 0, urban = 0, mountainous =0, russ_pop = 0, pop_fem_share = 0.5, family = 0, year = 2013)
newdata8 = data.frame(com_exposure = 1, urban = 0, mountainous =0, russ_pop = 0, pop_fem_share = 0.5, family = 0, year = 2013)

predict(m1, newdata7, type = "response")
predict(m1, newdata8, type = "response")

# I wonder why Lazarev did not continue the comparisons with non-family related cases? Perhaps the coefficients that he found in the previous code chunk were not significant enough for non-family-related cases that he decided it was not worth his time. Maybe he was just messing around and trying things. Either way, he didn't end up stargazer()-ing them. 
```

```{r eval = FALSE}
figdat <- read.csv2("raw-data/wp_data_raw.csv")

# This chunk reads in the data_raw csv. Am changing to "figdat" to avoid confusion with the first "data" title.
```

```{r fig2int, eval = FALSE}
# NOTE: Above

# This code was originally here, but the link threw an Error 404, so I'm just putting it in the comments. suppressMessages("https://raw.github.com/gerasy1987/useful_r/master/functions.R" %>% devtools::source_url()). My guess is that this was simply used to make sure that the code ran smoother.

# Below, Lazarev walks us through the creation of his multiplot() function. 

multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
  library(grid)
  
  # Make a list from the ... arguments and plotlist [LAZAREV NOTE]
  plots <- c(list(...), plotlist)
  
  numPlots = length(plots)
  
  # If layout is NULL, then use 'cols' to determine layout [LAZAREV NOTE]
  if (is.null(layout)) {
    # Make the panel [LAZAREV NOTE]
    # ncol: Number of columns of plots [LAZAREV NOTE]
    # nrow: Number of rows needed, calculated from # of cols [LAZAREV NOTE]
    layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
                     ncol = cols, nrow = ceiling(numPlots/cols))
  }
  
  if (numPlots==1) {
    print(plots[[1]])
    
  } else {
    # Set up the page [LAZAREV NOTE]
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
    
    # Make each plot, in the correct location [LAZAREV NOTE]
    for (i in 1:numPlots) {
      # Get the i,j matrix positions of the regions that contain this subplot [LAZAREV NOTE]
      matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
      
      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                                      layout.pos.col = matchidx$col))
    }
  }
}
```

```{r chilcus, eval = FALSE}

# This is code for a ggplot regarding child custody, represented by Q1 in the data. NAs are removed at the beginning. The bars in the geom_bar are represented by decimals -- how many people answer one type of court divided by the total number of answers.

h1 <- ggplot(data=figdat[!is.na(figdat$Q1),], 
             aes(factor(Q1))) + 
  geom_bar(aes(y = (..count..)/sum(..count..)),
           fill=("grey69"), position = "dodge") + 
  geom_text(aes(y = ((..count..)/sum(..count..)), 
                label = round((..count..)/sum(..count..), digits = 2)), 
            stat = "count", vjust = -0.25, size = 8) +
  
# He writes in the values using geom_text(), specifying position, size and number of digits to include, then sets the y-axis limits and the x labels, assigning 1 to State Law, 2 to Sharia, 3 to Adat, and 4 to Don't Know. He then labels his graph. 
  
  scale_y_continuous(limits=c(0, .8)) +
  scale_x_discrete(labels=c("1" = "State Law","2" = "Sharia","3" = "Adat", "4" = "Don't Know")) +
  labs(title = "Child Custody",
       y = "Share",
       x = "")

# NOTE: Originally, Lazarev included a theme_few() call with base_family set to "Helvetica". Unfortunately, I was unable to pull this font up in R, so I just went ahead and deleted the line. It doesn't change the data -- the font will just look a bit different.
```

```{r domvi, eval = FALSE}

# This plot is exactly the same as the previous one, but it uses Q3 instead of Q1.

h2 <- ggplot(data=figdat[!is.na(figdat$Q3_graph),], 
             aes(factor(Q3_graph))) + 
  geom_bar(aes(y = (..count..)/sum(..count..)),
           fill=("grey69"), position = "dodge") + 
  geom_text(aes(y = ((..count..)/sum(..count..)), 
                label = round((..count..)/sum(..count..), digits = 2)), 
            stat = "count", vjust = -0.25, size = 8) +
  scale_y_continuous(limits=c(0, .8)) +
  scale_x_discrete(labels=c("1" = "State Law","2" = "Sharia","3" = "Adat", "4" = "Don't Know")) +
  labs(title = "Domestic Violence",
       y = "Share",
       x = "")
```

```{r brikid, eval = FALSE}

# This plot is exactly the same as the previous one, but it uses Q5. 

h3 <- ggplot(data=figdat[!is.na(figdat$Q5_graph),], 
             aes(factor(Q5_graph))) + 
  geom_bar(aes(y = (..count..)/sum(..count..)),
           fill=("grey69"), position = "dodge") + 
  geom_text(aes(y = ((..count..)/sum(..count..)), 
                label = round((..count..)/sum(..count..), digits = 2)), 
            stat = "count", vjust = -0.25, size = 8) +
  scale_y_continuous(limits=c(0, .8)) +
  scale_x_discrete(labels=c("1" = "State Law","2" = "Sharia","3" = "Adat", "4" = "Don't Know")) +
  labs(title = "Bride Kidnapping",
       y = "Share",
       x = "")
```

```{r honkil, eval = FALSE}

# This plot is exactly the same as the previous one, but it uses Q8.

h4 <- ggplot(data=figdat[!is.na(figdat$Q8_graph),], 
             aes(factor(Q8_graph))) + 
  geom_bar(aes(y = (..count..)/sum(..count..)),
           fill=("grey69"), position = "dodge") + 
  geom_text(aes(y = ((..count..)/sum(..count..)), 
                label = round((..count..)/sum(..count..), digits = 2)), 
            stat = "count", vjust = -0.25, size = 8) +
  scale_y_continuous(limits=c(0, .8)) +
  scale_x_discrete(labels=c("1" = "State Law","2" = "Sharia","3" = "Adat", "4" = "Don't Know")) +
  labs(title = "Honor Killing",
       y = "Share",
       x = "")
```

```{r polgy, eval = FALSE}

# This plot is exactly the same as the previous one, but it uses Q10.

h5 <- ggplot(data=figdat[!is.na(figdat$Q10),], 
             aes(factor(Q10))) + 
  geom_bar(aes(y = (..count..)/sum(..count..)),
           fill=("grey69"), position = "dodge") + 
  geom_text(aes(y = ((..count..)/sum(..count..)), 
                label = round((..count..)/sum(..count..), digits = 2)), 
            stat = "count", vjust = -0.25, size = 8) +
  scale_y_continuous(limits=c(0, .8)) +
  scale_x_discrete(labels=c("1" = "State Law","2" = "Sharia","3" = "Adat", "4" = "Don't Know")) +
  labs(title = "Polygamy",
       y = "Share",
       x = "")
```

```{r inher, eval = FALSE}
table(figdat$Q12)

# The plot is exactly the same as the previous one, but it uses Q8. However, for whatever reason, he puts a table of the values above it. The above code produces the number of "1", "2", "3", and "4" responses, that correspond to Russian Law, Sharia, Adat, and Don't Know, respectively. I'm not sure why he did this; the plot works fine with or without this step. 

h6 <- ggplot(data=figdat[!is.na(figdat$Q12),], 
             aes(factor(Q12))) + 
  geom_bar(aes(y = (..count..)/sum(..count..)),
           fill=("grey69"), position = "dodge") + 
  geom_text(aes(y = ((..count..)/sum(..count..)), 
                label = round((..count..)/sum(..count..), digits = 2)), 
            stat = "count", vjust = -0.25, size = 8) +
  scale_y_continuous(limits=c(0, .8)) +
  scale_x_discrete(labels=c("1" = "State Law","2" = "Sharia","3" = "Adat", "4" = "Don't Know")) +
  labs(title = "Inheritance",
       y = "Share",
       x = "")
```

```{r propert, eval = FALSE}
table(figdat$Q14)

# Same code as before, same question about above table() call. 

h7 <- ggplot(data=figdat[!is.na(figdat$Q14),], 
             aes(factor(Q14))) + 
  geom_bar(aes(y = (..count..)/sum(..count..)),
           fill=("grey69"), position = "dodge") + 
  geom_text(aes(y = ((..count..)/sum(..count..)), 
                label = round((..count..)/sum(..count..), digits = 2)), 
            stat = "count", vjust = -0.25, size = 8) +
  scale_y_continuous(limits=c(0, .8)) +
  scale_x_discrete(labels=c("1" = "State Law","2" = "Sharia","3" = "Adat", "4" = "Don't Know")) +
  labs(title = "Property",
       y = "Share",
       x = "")

```

```{r carinc, eval = FALSE}
table(figdat$Q16)

# Same code as before, same question about above table() call. 

h8 <- ggplot(data=figdat[!is.na(figdat$Q16),], 
             aes(factor(Q16))) + 
  geom_bar(aes(y = (..count..)/sum(..count..)),
           fill=("grey69"), position = "dodge") + 
  geom_text(aes(y = ((..count..)/sum(..count..)), 
                label = round((..count..)/sum(..count..), digits = 2)), 
            stat = "count", vjust = -0.25, size = 8) +
  scale_y_continuous(limits=c(0, .8)) +
  scale_x_discrete(labels=c("1" = "State Law","2" = "Sharia","3" = "Adat", "4" = "Don't Know")) +
  labs(title = "Car Accident",
       y = "Share",
       x = "")
```

```{r dbet, eval = FALSE}
table(figdat$Q18)

# Same code as before, same question about above table() call. 

h9 <- ggplot(data=figdat[!is.na(figdat$Q18),], 
             aes(factor(Q18))) + 
  geom_bar(aes(y = (..count..)/sum(..count..)),
           fill=("grey69"), position = "dodge") + 
  geom_text(aes(y = ((..count..)/sum(..count..)), 
                label = round((..count..)/sum(..count..), digits = 2)), 
            stat = "count", vjust = -0.25, size = 8) +
  scale_y_continuous(limits=c(0, .8)) +
  scale_x_discrete(labels=c("1" = "State Law","2" = "Sharia","3" = "Adat", "4" = "Don't Know")) +
  labs(title = "Debt",
       y = "Share",
       x = "")
```

```{r mudr, eval = FALSE}
table(figdat$Q20)

# Same code as before, same question about above table() call. 

h10 <- ggplot(data=figdat[!is.na(figdat$Q20),], 
              aes(factor(Q20))) + 
  geom_bar(aes(y = (..count..)/sum(..count..)),
           fill=("grey69"), position = "dodge") + 
  geom_text(aes(y = ((..count..)/sum(..count..)), 
                label = round((..count..)/sum(..count..), digits = 2)), 
            stat = "count", vjust = -0.25, size = 8) +
  scale_y_continuous(limits=c(0, .8)) +
  scale_x_discrete(labels=c("1" = "State Law","2" = "Sharia","3" = "Adat", "4" = "Don't Know")) +
  labs(title = "Murder",
       y = "Share",
       x = "")


figure2 <- multiplot(h1, h2, h3, h4, h5, h6, h7, h8, h9, h10, cols = 2)

# The above code finally uses the multiplot() function that Lazarev created in the code chunk above all of these plots. Works very similarly to the ggarrange() function in the ggpubr package.
```

```{r figth, eval = FALSE}

# Starts on page 685. Reads in survey data.

fig3dat <- read.csv2("raw-data/upd_wp_data_survey.csv")

# Here, Lazarev creates a function that can be applied to a vector of "x" values. The numerator of the function is the minimum value of x subtracted from the given value of x over the range of the vector (maximum-minimum).

range01 <- function(x) {(x - min(x))/(max(x) - min(x))}

# Loads plyr package. The require() function is designed to return FALSE and throw an error when a certain function is run without the indicated package being loaded.

require(plyr)
length2 <- function (x, na.rm=FALSE) {
  if (na.rm) sum(!is.na(x))
  else       length(x)
}

# The above function is essentially just the length() function, but it makes sure that it stops if the sum of the vector contains NAs. Meant to streamline workflow. 

if (!require(pacman)) install.packages("pacman")

# Calling p_load checks to see if the listed packages have been installed, and if not, it attempts to install the package.

pacman::p_load(readr, ggplot2, plyr, dplyr, magrittr, tidyr, purrr, ggthemes)

# I'm pretty sure that tapply() here is calling to apply the mean() function of the data$indexRL vector over the data$female factor. So the 0 and 1 here should be referring to 0 being non-female and 1 being female. The round() function makes it only keep 3 decimals. The same is true for sds1. For n1, round() is not necessary, because the length2 function won't give back decimals. 

means1 <- round(tapply(fig3dat$indexRL, fig3dat$female, mean, na.rm = T), digits=3)
sds1 <- round(tapply(fig3dat$indexRL, fig3dat$female, sd, na.rm = T), digits=3)
n1 <- tapply(fig3dat$indexRL, fig3dat$female, length2, na.rm = T)

# se1 is standard error and is just the standard error function: the standard deviation (sds1) divided by the square root of the length. 

se1 <- round(sds1/sqrt(n1), digits=3)

# qt() is the quantile function. You can use it to find out what the t-score is of the pth quantile (in this case, the 97.5th quantile). df stands for degress of freedom. In this case, it is equal to the length minus 1. This is typical, as 1 is the number of parameters we need, and the typical equation is the length minus number of parameters. He then multiplies it by the standard error. This gets used later as the determinant for the error bar in the graph.

error1 <- round((qt(0.975,df=n1-1)*se1), digits = 3)

# The below two vectors are used to define various aspects of the data. min is used to represent male versus female, with male being 0 and female being one. object1 is used to define which index we're looking at here: Russian Law, Sharia, or Adat. In this case, object1 is a vector of 2 "1"s; in the next one, object2 is a vector of 2 "2"s, and in the last one, object3 is a vector of 2 "3"s.

min <- c(0,1)
object1 <- c(1,1)

# The below chunk repeats the above process for data$indexS.

means2 <- round(tapply(fig3dat$indexS, fig3dat$female, mean, na.rm = T), digits=3)
sds2 <- round(tapply(fig3dat$indexS, fig3dat$female, sd, na.rm = T), digits=3)
n2 <- tapply(fig3dat$indexS, fig3dat$female, length2, na.rm = T)
se2 <- round(sds2/sqrt(n2), digits=3)
error2 <- round((qt(0.975,df=n2-1)*se2), digits = 3)
object2 <- c(2,2)

# The below chunk repeats the earlier process for data$indexA. 

means3 <- round(tapply(fig3dat$indexA, fig3dat$female, mean, na.rm = T), digits=3)
sds3 <- round(tapply(fig3dat$indexA, fig3dat$female, sd, na.rm = T), digits=3)
n3 <- tapply(fig3dat$indexA, fig3dat$female, length2, na.rm = T)
se3 <- round(sds3/sqrt(n3), digits=3)
error3 <- round((qt(0.975,df=n3-1)*se3), digits = 3)
object3 <- c(3,3)

# The below code puts all of the above numbers into a data frame. sb is the resulting dataframe.

V1_dat <- rbind(cbind(object1, min, means1, sds1, n1, se1, error1, deparse.level=0),
                cbind(object2, min, means2, sds2, n2, se2, error2, deparse.level=0),
                cbind(object3, min, means3, sds3, n3, se3, error3, deparse.level=0))

rownames(V1_dat) <- c(1:6) 
colnames(V1_dat) <- c("sum", "min", "put", "sds", "n", "se", "error") 
sb <- as.data.frame(V1_dat)


sb2 <- sb

# Changed min and sum vectors into factors.

sb2$min <- as.factor(sb2$min) 
sb2$sum <- as.factor(sb2$sum)
levels(sb2$sum) <- c("State Law", "Sharia", "Adat") 

# This ggplot puts which type of law on the x-axis and the means that we generated on the y-axis. The fill is determined by male or female. This is meant to show how women prefer state law, and men prefer sharia and adat.

figure3 <- ggplot(sb2, aes(x=sum, y=put, fill = min)) + 
  geom_bar(position=position_dodge(), 
           stat="identity", size=.3) + 
  
# The geom_errorbar() addition adds on a small bar at the top of the graph to indicate how much error there is. The top is the estimate plus the error, and the bottom of the bar is the estimate minus the error. 
  
  geom_errorbar(aes(ymin=put-error, ymax=put+error),
                size=.5,    # Thinner lines
                width=.3,
                position=position_dodge(.9)) +
  
# This is all just formatting below. 
  
  xlab("") +
  ylab("") +
  ggtitle("") +
  coord_cartesian(ylim=c(0, .5))+  
  scale_y_continuous(breaks=seq(0, 0.5, .1)) +
  scale_fill_manual(name="Gender", # Legend label, use darker colors
                    # breaks=c("1", "2", "3"),
                    breaks=c("0", "1"), 
                    labels=c("male", 
                             "female"),
                    values=c("cornsilk3", "gray33")) +
  theme(text = element_text(size=25),
        axis.line = element_line(colour = "black"),
        axis.title.x = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank())

# The end part of the formatting here takes off a ton of stuff in the graph. 
```

```{r figfiv, eval = FALSE}
fig5data <- read.csv2("raw-data/upd_wp_data_survey.csv")

# Again, very much irritates me that he writes over his code and then reads it in again. I have at least changed what the data is called. 

fig5data$victimized[fig5data$com_exposure=='0']<-'nonvictimized'
fig5data$victimized[fig5data$com_exposure=='1']<-'victimized'

# Here he decides to finally label com_exposure as victimized or nonvictimized, as he uses throughout his paper. He cleans some things up below too, regarding male and female. My guess is that he does this so that it works better with cat_plot, instead of having 0 and 1 for both, that could theoretically be read as numbers.

fig5data$gender[fig5data$female=='0']<-'male'
fig5data$gender[fig5data$female=='1']<-'female'

# Below, he creates a regression that analyzes the effect of the interaction of victimized and gender on indexRL, controlling for a lot of other variables. It is the same as in the first chunk of "predicted variables," just with a couple of renamed variables. 

m1 <- lm(indexRL ~ victimized*gender + 
           as.factor(age_cohorts) + incomefull + edufull + unemployed + urban_com +
           russ_pop + lmaltitude + ldistance_Grozny + lcom_size, data = fig5data)
summary(m1)

# cat_plot() is used to plot interactions. Both the predictor and the moderator are categorical -- there are tow options "nonvictimized" and "victimized" and "male" and "female." The model is m1, the predictor is the victimized variable, and the moderator is the gender variable. Four bars are spit out: nonvictimized male, nonvictimized female, victimized male, and victimized female. The y-axis is the indexRL. 

figure5 <- cat_plot(m1, pred = victimized, modx = gender, geom = "bar") + 
  labs(x="", y = "") +
  scale_color_manual("gender", values=c('grey20','grey60'))+
  scale_fill_manual("gender",values=c('grey30','grey80'))
  
```          

```{r figsx, eval = FALSE}

total <- read.csv2("raw-data/wp_data_Chechnya_Ingushetia.csv")

# Reads in comparative data. Then, he splits it up into two dataframes -- ftotal and mtotal, for women and men. 

ftotal <- total[which(total$data.female==1),]
mtotal <- total[which(total$data.female==0),]

# The below two sets of code are exactly the same as in the code chunk a little ways up that I already put in a lot of comments for. This time, there are only two of these chunks instead of three, because the point is to show support for Russian law as it compares across two republics: Chechnya and Ingushetia, instead of comparing across three types of law (Russian, sharia and adat). I would personally be curious to see what the data shows about sharia and adat as well for these comparisons.

means1 <- round(tapply(ftotal$data.indexRL, ftotal$chechnya, mean, na.rm = T), digits=3)
sds1 <- round(tapply(ftotal$data.indexRL, ftotal$chechnya, sd, na.rm = T), digits=3)
n1 <- tapply(ftotal$data.indexRL, ftotal$chechnya, length2, na.rm = T)
se1 <- round(sds1/sqrt(n1), digits=3)
error1 <- round((qt(0.975,df=n1-1)*se1), digits = 3)
min <- c(0,1)
object1 <- c(1,1)

means2 <- round(tapply(mtotal$data.indexRL, mtotal$chechnya, mean, na.rm = T), digits=3)
sds2 <- round(tapply(mtotal$data.indexRL, mtotal$chechnya, sd, na.rm = T), digits=3)
n2 <- tapply(mtotal$data.indexRL, mtotal$chechnya, length2, na.rm = T)
se2 <- round(sds2/sqrt(n2), digits=3)
error2 <- round((qt(0.975,df=n2-1)*se2), digits = 3)
min <- c(0,1)
object2 <- c(2,2)

# Again, this is the exact same process as in the code beforehand. 

V1_dat <- rbind(cbind(object1, min, means1, sds1, n1, se1, error1, deparse.level=0),
                cbind(object2, min, means2, sds2, n2, se2, error2, deparse.level=0))

rownames(V1_dat) <- c(1:4) 
colnames(V1_dat) <- c("sum", "min", "put", "sds", "n", "se", "error") 
sb <- as.data.frame(V1_dat)

sb2 <- sb
sb2$min <- as.factor(sb2$min) 
sb2$sum <- as.factor(sb2$sum)
levels(sb2$sum) <- c("Women", "Men") 

figure6 <- ggplot(sb2, aes(x=sum, y=put, fill = min)) + 
  geom_bar(position=position_dodge(), 
           stat="identity", size=.3) +      
  geom_errorbar(aes(ymin=put-error, ymax=put+error),
                size=.5,    # Thinner lines
                width=.3,
                position=position_dodge(.9)) +
  xlab("") +
  ylab("") +
  ggtitle("") +
  coord_cartesian(ylim=c(0, .5))+  
  scale_y_continuous(breaks=seq(0, 0.5, .1)) +
  scale_fill_manual(name="Region", # Legend label, use darker colors
                    # breaks=c("1", "2", "3"),
                    breaks=c("0", "1"), 
                    labels=c("Ingushetia", 
                             "Chechnya"),
                    values=c("gray88", "grey44")) +
  theme(text = element_text(size=25),
        axis.line = element_line(colour = "black"),
        axis.title.x = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank())

# All of the formatting is the same for this graph as for the last one of this type. It shows what percentage of Chechen women vs. Ingush women prefer Russian law in comparison to how many Chechen men vs. Ingush men prefer Russian law. 
```

# References
